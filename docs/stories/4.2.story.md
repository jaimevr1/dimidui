# Story 4.2: Gestão de Alunos e Atribuição

- **Status**: Draft
- **Epic**: 4
- **Release**: 1.0

## Story
As a: Professor,
I want: Cadastrar novos alunos na minha turma e atribuir atividades a eles,
so that: Eu possa gerenciar quem faz o quê.

## Acceptance Criteria
1.  Deve haver uma interface para adicionar um novo aluno (nome, senha, série).
2.  Na página de detalhes do aluno ou da turma, o professor deve poder selecionar uma ou mais atividades e atribuí-las a um ou mais alunos.
3.  A atribuição deve criar um registro na tabela `activity_assignments`.

## Dev Notes

### Fluxo de Gestão
Esta funcionalidade complementa o dashboard do professor. A criação de alunos pode ser uma modal na página principal do dashboard. A atribuição de atividades pode ser uma ação disponível tanto na visão geral da turma (para atribuir a vários alunos de uma vez) quanto na página de detalhes de um aluno específico.

- **Fonte**: `docs/prd/user-interface-design-goals.md`

### Interação com o Banco de Dados
- **Criação de Aluno**: Requer um `insert()` na tabela `students`.
- **Atribuição de Atividade**: Requer um `insert()` na tabela `activity_assignments`. Será preciso uma interface para selecionar quais atividades (`activities`) e quais alunos (`students`) farão parte da atribuição.

- **Fonte**: `docs/architecture/5-database-schema.md`

## Tasks / Subtasks

1.  **Implementar a Interface de Criação de Aluno (AC: 1)**
    - [ ] No `professor-dashboard.html`, adicione um botão "+ Novo Aluno".
    - [ ] Crie uma modal que é aberta por este botão.
    - [ ] A modal deve conter um formulário com campos para `name`, `password` e `grade_level` (série).
    - [ ] No script `professor-dashboard.js`, implemente a lógica para pegar os dados do formulário e fazer um `insert()` na tabela `students` do Supabase.
    - [ ] Após a criação, a lista de alunos no dashboard deve ser atualizada.

2.  **Implementar a Interface de Atribuição de Atividade (AC: 2)**
    - [ ] Adicione um botão "Atribuir Atividade" no `professor-dashboard.html`.
    - [ ] Ao clicar, abra uma modal.
    - [ ] A modal deve conter duas listas com checkboxes:
        - Uma lista de todos os alunos.
        - Uma lista de todas as atividades existentes.
    - [ ] O script deve buscar os dados para popular essas duas listas das tabelas `students` e `activities`.

3.  **Implementar a Lógica de Atribuição (AC: 3)**
    - [ ] Adicione um botão "Salvar Atribuição" na modal.
    - [ ] Ao clicar, o script deve iterar sobre todos os alunos selecionados e todas as atividades selecionadas.
    - [ ] Para cada par `(aluno, atividade)`, o script deve criar um objeto `{ student_id: ..., activity_id: ... }`.
    - [ ] Use o cliente Supabase para fazer um `insert()` de todos esses objetos na tabela `activity_assignments`.
    - [ ] Feche a modal e forneça um feedback de sucesso.

4.  **Verificação Manual**
    - [ ] No dashboard do professor, clique em "+ Novo Aluno", preencha os dados e salve. Verifique se o novo aluno aparece na lista de alunos e na tabela `students` do Supabase.
    - [ ] Clique em "Atribuir Atividade". Verifique se a modal abre e se as listas de alunos e atividades são populadas corretamente.
    - [ ] Selecione 1 atividade e 2 alunos. Salve a atribuição.
    - [ ] Verifique na tabela `activity_assignments` do Supabase se os dois novos registros foram criados corretamente.
    - [ ] Faça login como um dos alunos que recebeu a atribuição e verifique se a nova atividade aparece em seu dashboard.
