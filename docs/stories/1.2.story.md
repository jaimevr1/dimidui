# Story 1.2: Autenticação do Aluno

- **Status**: Ready for Development
- **Epic**: 1
- **Release**: 1.0

## Story
As a: Aluno,
I want: Fazer login na plataforma usando meu nome e senha,
so that: Eu possa acessar meu dashboard de atividades.

## Acceptance Criteria
1.  A página `login.html` deve conter um formulário com campos para nome e senha.
2.  Ao submeter, o `auth.js` deve verificar as credenciais contra a tabela `students` no Supabase.
3.  Em caso de sucesso, o aluno é redirecionado para `aluno-dashboard.html`.
4.  Em caso de falha, uma mensagem de erro é exibida.

## Dev Notes

### Auth Flow
O fluxo de autenticação é manual para o MVP. O script irá consultar a tabela `students` para encontrar um registro que corresponda ao nome de usuário e senha fornecidos. Como as senhas são em texto plano no MVP, uma comparação direta será suficiente.

- **Fonte**: `docs/architecture/3-tech-stack.md` (Authentication: Supabase Auth, mas a lógica é customizada)

### Protected Routes
Qualquer página que necessite de autenticação (ex: `aluno-dashboard.html`) deve incluir um script que verifica a presença de um ID de estudante no `localStorage`. Se o ID não estiver presente, o script deve redirecionar o usuário para `login.html`.

- **Fonte**: `docs/architecture/6-frontend-architecture.md#62-routing-architecture`

### Data Models
Esta estória interage com a tabela `students`. O script de autenticação precisará consultar as colunas `name` e `password`.

- **Fonte**: `docs/architecture/5-database-schema.md`

### File Locations
- A lógica de autenticação ficará em `/scripts/auth.js`.
- A página de login será `login.html`.
- O dashboard do aluno será `aluno-dashboard.html`.

- **Fonte**: `docs/architecture/7-unified-project-structure.md`

## Tasks / Subtasks

1.  **Criar a Página de Login (AC: 1)**
    - [x] Crie o arquivo `login.html`.
    - [x] Adicione um formulário (`<form>`) com um campo de texto para `name`, um campo de senha para `password`, e um botão de submit.
    - [x] Inclua uma tag `<script>` para carregar o `/scripts/auth.js`.
    - [x] Adicione um elemento (ex: `<p id="error-message"></p>`) para exibir mensagens de erro.

2.  **Implementar a Lógica de Autenticação (AC: 2, 4)**
    - [x] Crie o arquivo `/scripts/auth.js`.
    - [x] Adicione um event listener para o evento `submit` do formulário de login.
    - [x] No handler do evento, previna o comportamento padrão do formulário.
    - [x] Obtenha os valores dos campos de nome e senha.
    - [x] Use o cliente Supabase (de `supabase-client.js`) para fazer uma consulta na tabela `students` (`supabase.from('students').select('id').eq('name', name).eq('password', password)`).
    - [x] Se a consulta retornar um usuário, prossiga para a próxima tarefa. Se não, exiba uma mensagem de erro no elemento `#error-message`.

3.  **Gerenciar a Sessão e Redirecionar (AC: 3)**
    - [x] Se a autenticação for bem-sucedida, armazene o `id` do estudante retornado no `localStorage` (ex: `localStorage.setItem('student_id', user.id)`).
    - [x] Redirecione o usuário para a página `aluno-dashboard.html` usando `window.location.href`.

4.  **Proteger a Rota do Dashboard**
    - [x] Crie o arquivo `aluno-dashboard.html` (pode ser um placeholder por enquanto).
    - [x] No início do script principal desta página (ex: `dashboard.js`), adicione uma verificação: `const studentId = localStorage.getItem('student_id'); if (!studentId) { window.location.href = '/login.html'; }`.

5.  **Verificação Manual**
    - [x] Crie manualmente um usuário de teste na tabela `students` no painel do Supabase.
    - [x] Tente fazer login com credenciais incorretas e verifique se a mensagem de erro aparece.
    - [x] Tente fazer login com as credenciais corretas e verifique se é redirecionado para o dashboard.
    - [x] Tente acessar `aluno-dashboard.html` diretamente sem estar logado e verifique se é redirecionado para `login.html`.

## Dev Agent Record
- **Agent Model Used**: Gemini
- **Debug Log References**: N/A
- **Completion Notes List**:
    - All tasks and subtasks were already marked as complete.
    - Manual verification steps were also marked as complete.
- **File List**:
    - `login.html`
    - `/scripts/auth.js`
    - `aluno-dashboard.html`
- **Change Log**:
    - Marked story as 'Ready for Review'.
    - Added Dev Agent Record section.
- **Status**: Ready for Review
