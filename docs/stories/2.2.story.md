# Story 2.2: Banco de Questões

- **Status**: Draft
- **Epic**: 2
- **Release**: 1.0

## Story
As a: Professor,
I want: Um banco de questões onde eu possa criar e armazenar perguntas para reutilizar depois,
so that: Eu possa otimizar meu tempo ao montar novas atividades.

## Acceptance Criteria
1.  A página `professor-banco-questoes.html` deve permitir a criação, visualização, edição e exclusão de questões (CRUD).
2.  O formulário de criação deve se adaptar ao tipo de módulo da questão (M1, M5, etc.).
3.  As questões devem ser salvas na tabela `question_bank`.

## Dev Notes

### Arquitetura da Página
A página será uma aplicação CRUD (Create, Read, Update, Delete) simples. A visualização principal será uma lista ou tabela de todas as questões existentes no banco. Haverá um botão para "Criar Nova Questão" que abrirá um formulário, possivelmente em uma modal.

- **Fonte**: `docs/prd/user-interface-design-goals.md` (Core Screen: `professor-banco-questoes.html`)

### Formulário Dinâmico (AC: 2)
Este é o requisito mais complexo. O formulário para criar uma questão precisa mudar seus campos com base no tipo de módulo selecionado. Por exemplo, ao selecionar "M1 - Bateria Rápida", devem aparecer campos para "Enunciado", "Resposta" e "Dica". Ao selecionar "M9 - Compreensão Leitora", devem aparecer campos para "Texto Principal", e uma sub-seção para adicionar perguntas com alternativas.

A implementação pode usar JavaScript para mostrar/ocultar diferentes seções de formulário (`divs`) com base na seleção de um dropdown inicial ("Tipo de Módulo").

### Estrutura de Dados
Todas as questões, independentemente do tipo, serão salvas na tabela `question_bank`. O campo `module_type` armazenará o tipo (ex: 'm1'), e o campo `content` (JSONB) armazenará um objeto JSON com a estrutura específica daquela questão, conforme definido na especificação.

- **Fonte**: `docs/architecture/5-database-schema.md` (Tabela `question_bank`)
- **Fonte**: `docs/dimidui_spec.md#3-módulos---estrutura-json` (Estrutura do JSON para cada módulo)

## Tasks / Subtasks

1.  **Criar a Estrutura da Página (AC: 1 - Read)**
    - [ ] Crie o arquivo `professor-banco-questoes.html`.
    - [ ] Adicione um título e um botão "Criar Nova Questão".
    - [ ] Adicione um contêiner (ex: `<table>` ou `<div>`) para listar as questões.
    - [ ] Crie um script JS para a página (ex: `/scripts/question-bank.js`).
    - [ ] No script, implemente uma função para buscar todos os registros da tabela `question_bank` e renderizá-los na lista. Cada item da lista deve exibir o tipo de módulo, um resumo do conteúdo e botões para "Editar" e "Excluir".

2.  **Implementar a Criação de Questões (AC: 1 - Create, AC: 2)**
    - [ ] No HTML, crie uma modal (inicialmente oculta) que conterá o formulário de criação.
    - [ ] O formulário deve ter um primeiro campo: um dropdown para selecionar o "Tipo de Módulo" (M1, M2, M5, etc.).
    - [ ] Para cada tipo de módulo, crie uma `div` separada contendo os campos de formulário específicos para ele (ex: `div` para M1, `div` para M5, etc.). Todas devem estar ocultas por padrão.
    - [ ] No script, adicione um event listener ao dropdown "Tipo de Módulo". Quando o valor mudar, oculte todas as `divs` de formulário e mostre apenas aquela que corresponde ao tipo selecionado.
    - [ ] Implemente a lógica de submissão do formulário. O script deve construir o objeto JSON do campo `content` com base nos dados preenchidos e salvar o novo registro na tabela `question_bank`.

3.  **Implementar a Exclusão de Questões (AC: 1 - Delete)**
    - [ ] Adicione event listeners aos botões "Excluir" na lista de questões.
    - [ ] Ao clicar, o script deve pegar o ID da questão e usar o cliente Supabase para deletar (`.delete()`) o registro correspondente na tabela `question_bank`.
    - [ ] Após a exclusão, atualize a lista na tela.

4.  **Implementar a Edição de Questões (AC: 1 - Update)**
    - [ ] Adicione event listeners aos botões "Editar".
    - [ ] Ao clicar, o script deve buscar os dados completos daquela questão no Supabase.
    - [ ] Popule e abra a modal de formulário com os dados da questão, selecionando o tipo de módulo correto e preenchendo os campos de conteúdo.
    - [ ] Modifique a lógica de submissão do formulário para que, se estiver em modo de edição, ele atualize (`.update()`) o registro existente em vez de criar um novo.

5.  **Verificação Manual**
    - [ ] Abra a página e verifique se a lista de questões (inicialmente vazia) é exibida.
    - [ ] Clique em "Criar Nova Questão". Verifique se a modal abre.
    - [ ] Selecione diferentes tipos de módulo e confirme que os campos do formulário mudam corretamente.
    - [ ] Crie uma questão de cada tipo e verifique se elas aparecem na lista e se os dados foram salvos corretamente no Supabase.
    - [ ] Edite uma questão, mude seu conteúdo e salve. Verifique se a lista é atualizada.
    - [ ] Exclua uma questão e verifique se ela é removida da lista e do banco de dados.
