# Story 3.1: Implementação dos Módulos M2, M6, M8

- **Status**: Draft
- **Epic**: 3
- **Release**: 1.0

## Story
As a: Aluno,
I want: Realizar atividades dos tipos "Linha Numérica" (M2), "Destaca Palavra" (M6) e "Corrige Ortografia" (M8),
so that: Eu possa praticar uma gama maior de habilidades.

## Acceptance Criteria
1.  O `m2-linha.js` deve renderizar uma linha numérica e permitir arrastar pontos até o local correto.
2.  O `m6-palavra.js` deve permitir que o aluno clique em palavras em um texto para selecioná-las.
3.  O `m8-ortografia.js` deve apresentar uma questão de múltipla escolha para corrigir uma palavra.
4.  A lógica de 3 tentativas deve ser funcional para todos os novos módulos.

## Dev Notes

### Lógica de Módulo
Assim como na Estória 1.4, cada módulo será um arquivo JavaScript autocontido que exporta uma função `render(config, container, onComplete)`. Eles serão chamados pelo `activity-runtime.js`.

- **Fonte**: `docs/architecture/6-frontend-architecture.md#61-component-architecture`

### Interatividade
- **M2 (Linha Numérica)**: Requerirá a implementação de lógica de arrastar e soltar (drag-and-drop) em JavaScript. É preciso calcular a posição do ponto na linha para determinar o valor selecionado pelo usuário.
- **M6 (Destaca Palavra)**: Requerirá a divisão do texto em palavras (talvez envolvendo cada palavra em um `<span>`) e a adição de event listeners de clique a cada uma.

### Estrutura de Dados
As configurações para cada módulo virão do objeto de atividade, conforme as estruturas JSON definidas na especificação.

- **Fonte**: `docs/dimidui_spec.md#3-módulos---estrutura-json`

## Tasks / Subtasks

1.  **Implementar Módulo M2 - Linha Numérica (AC: 1, 4)**
    - [ ] Crie o arquivo `/scripts/modules/m2-linha.js`.
    - [ ] Implemente a função `render(config, container, onComplete)`.
    - [ ] Renderize a linha numérica com os valores mínimo e máximo (`config.range_min`, `config.range_max`).
    - [ ] Renderize os pontos arrastáveis para cada item em `config.targets`.
    - [ ] Implemente a lógica de drag-and-drop para os pontos.
    - [ ] Ao soltar um ponto, calcule o valor correspondente na linha e compare com o alvo, considerando a `config.tolerance`.
    - [ ] Aplique a lógica de 3 tentativas e, ao final, chame `onComplete()`.

2.  **Implementar Módulo M6 - Destaca Palavra-Chave (AC: 2, 4)**
    - [ ] Crie o arquivo `/scripts/modules/m6-palavra.js`.
    - [ ] Implemente a função `render(config, container, onComplete)`.
    - [ ] Processe o `config.text`, envolvendo cada palavra em um elemento `<span>`.
    - [ ] Adicione um event listener de clique a cada `<span>`.
    - [ ] Mantenha um registro das palavras selecionadas pelo usuário.
    - [ ] Implemente um botão "Verificar" que compara as palavras selecionadas com `config.correct_words`.
    - [ ] Aplique a lógica de 3 tentativas e, ao final, chame `onComplete()`.

3.  **Implementar Módulo M8 - Corrige Ortografia (AC: 3, 4)**
    - [ ] Crie o arquivo `/scripts/modules/m8-ortografia.js`.
    - [ ] Implemente a função `render(config, container, onComplete)`.
    - [ ] Para cada questão em `config.questions`, renderize o texto (destacando a palavra errada) e as `config.options` como botões.
    - [ ] Adicione event listeners aos botões de opção.
    - [ ] Ao clicar, compare a opção selecionada com `config.correct`.
    - [ ] Aplique a lógica de 3 tentativas e, ao final, chame `onComplete()`.

4.  **Integrar Módulos ao Runtime**
    - [ ] Modifique o `/scripts/activity-runtime.js`.
    - [ ] Importe as novas funções de renderização dos módulos M2, M6 e M8.
    - [ ] Adicione-as ao objeto `moduleRenderers` para que o runtime possa chamá-las.

5.  **Verificação Manual**
    - [ ] Crie atividades de teste no Supabase, uma para cada novo tipo de módulo (M2, M6, M8).
    - [ ] Acesse cada atividade e verifique se a renderização e a interatividade funcionam conforme o esperado (drag-and-drop, clique na palavra, seleção de múltipla escolha).
    - [ ] Teste a lógica de 3 tentativas para cada um dos novos módulos.
